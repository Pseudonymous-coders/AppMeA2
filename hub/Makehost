# Use the builtin bash for file io
SHELL = /bin/sh

# Setup for local compiling
ARCH=amd64

# Use the standard system compiler (not cross compiling)
CXX = g++
CC = gcc

# g++ flags to be placed after each src file
CXXFLAGS = -Iinclude

# Static libs to add
LDFLAGS = -lpthread

# Remove files
RM = rm -f

# The name of the host file compiled
TARGET = slumberhost

SRCS = $(shell echo src/*.cpp)
HEADS = $(shell echo include/*.h)
OBJS = $(SRCS:.cpp=.o)
LIBS = lib/
OBJF = obj/
SRCF = src/
BINF = bin/

.PHONY: all
all: ${TARGET}

$(TARGET): $(OBJS)
	@echo Creating single static lib $(TARGET)
	$(CXX) -o $(BINF)$@ $^ $(CXXFLAGS) $(LDFLAGS)
	mv $(OBJS) $(OBJF)
	@echo Finished building! Find the compiled version in $(BINF)

$(OBJF)%.o: %.cpp $(HEADS)
	@echo Compiling... $<
	$(CXX) -o $@ $< $(CXXFLAGS)

.PHONY: clean
clean:
	@echo Removing singular compiles!
	-${RM} ${OBJS}
